# Outputs Dictionary

> **RESEARCH USE ONLY — NOT FOR CLINICAL DECISION-MAKING**
>
> All outputs from this framework are for research and hypothesis generation purposes only.
> They must NOT be used for clinical diagnosis, treatment decisions, or medical advice.
> All findings require independent experimental and clinical validation.

This document describes each output artifact generated by the Pathway Subtyping Framework, how to interpret the results, and critical limitations to keep in mind.

---

## Table of Contents

1. [Output Overview](#output-overview)
2. [pathway_scores.csv](#pathway_scorescsv)
3. [subtype_assignments.csv](#subtype_assignmentscsv)
4. [report.json](#reportjson)
5. [report.md](#reportmd)
6. [Validation Gates](#validation-gates)
7. [Interpretation Guardrails](#interpretation-guardrails)
8. [What NOT to Infer](#what-not-to-infer)

---

## Output Overview

All outputs are written to the configured output directory (default: `outputs/<run_name>/`).

```
outputs/<run_name>/
├── pathway_scores.csv        # Sample x Pathway score matrix
├── subtype_assignments.csv   # Cluster assignments with confidence
├── report.json               # Machine-readable summary
└── report.md                 # Human-readable report
```

---

## pathway_scores.csv

### Description
Z-score normalized pathway disruption scores for each sample.

### Format
CSV with samples as rows and pathways as columns.

```csv
,SYNAPTIC_TRANSMISSION,CHROMATIN_REMODELING,ION_CHANNEL,...
SAMPLE_001,1.23,-0.45,0.87,...
SAMPLE_002,-0.67,1.89,-0.12,...
```

### Columns

| Column | Type | Description |
|--------|------|-------------|
| (index) | string | Sample identifier |
| [pathway_name] | float | Z-score normalized pathway score |

### How to Interpret

- **Positive scores** (>0): Higher-than-average pathway disruption for this sample
- **Negative scores** (<0): Lower-than-average pathway disruption
- **Magnitude**: Larger absolute values indicate stronger deviation from the cohort mean
- **Units**: Standard deviations from the mean (Z-scores)

### Limitations

- Scores are relative to the cohort analyzed—they do not indicate absolute pathogenicity
- Pathway scores depend on which genes are present in the pathway database
- Missing genes in a pathway will underestimate disruption
- Scores are sensitive to cohort composition (batch effects possible)

### What NOT to Infer

- :x: "A score of 2.0 means the pathway is pathogenic"
- :x: "Negative scores mean the pathway is protective"
- :x: "This sample has disease because of high synaptic score"
- :white_check_mark: "This sample shows elevated disruption in synaptic pathways relative to this cohort"

---

## subtype_assignments.csv

### Description
Cluster/subtype assignments for each sample with confidence scores.

### Format

```csv
sample_id,cluster_id,cluster_label,confidence,planted_subtype
SAMPLE_001,0,synaptic,0.92,synaptic
SAMPLE_002,1,chromatin,0.78,chromatin
```

### Columns

| Column | Type | Description |
|--------|------|-------------|
| sample_id | string | Sample identifier |
| cluster_id | int | Numeric cluster ID (0-indexed) |
| cluster_label | string | Biological label based on dominant pathway |
| confidence | float | GMM posterior probability [0-1] |
| planted_subtype | string | Ground truth label (if available) |

### How to Interpret

- **cluster_id**: Arbitrary numeric identifier for the cluster
- **cluster_label**: Heuristic label based on which pathway has highest mean score in the cluster
- **confidence**: How confident the model is in this assignment
  - >0.9: High confidence
  - 0.7-0.9: Moderate confidence
  - <0.7: Low confidence (sample may be at cluster boundary)

### Limitations

- Cluster labels are heuristic—they are NOT validated biological subtypes
- The number of clusters is determined by BIC, which may over- or under-estimate true subtypes
- Confidence scores reflect model uncertainty, not biological validity
- Clustering is unsupervised—it finds patterns, not necessarily meaningful subtypes

### What NOT to Infer

- :x: "This patient has synaptic-type disease"
- :x: "Cluster 0 patients should receive different treatment"
- :x: "High confidence means this is definitely the right subtype"
- :white_check_mark: "This sample groups with others showing elevated synaptic pathway scores"

---

## report.json

### Description
Machine-readable summary for programmatic access.

### Schema

```json
{
  "run_name": "synthetic_test",
  "timestamp": "2026-01-29T10:42:30",
  "seed": 42,
  "summary": {
    "n_samples": 60,
    "n_pathways": 4,
    "n_clusters": 4,
    "optimal_k": 4
  },
  "clusters": {
    "0": {"count": 15, "label": "synaptic"},
    "1": {"count": 15, "label": "chromatin"},
    "2": {"count": 15, "label": "metabolic"},
    "3": {"count": 15, "label": "immune"}
  },
  "validation": {
    "all_passed": true,
    "label_shuffle": {"status": "PASS", "value": 0.02},
    "random_genes": {"status": "PASS", "value": 0.03},
    "bootstrap_stability": {"status": "PASS", "value": 0.85}
  },
  "ground_truth": {
    "ari": 0.92,
    "threshold_met": true
  },
  "threshold_calibration": {
    "null_ari_threshold": 0.0823,
    "stability_threshold": 0.7456,
    "n_samples": 60,
    "n_clusters": 4,
    "n_pathways": 15,
    "alpha": 0.05,
    "calibration_method": "lookup",
    "interpolated": false
  }
}
```

### Fields

| Field | Description |
|-------|-------------|
| run_name | Analysis identifier |
| timestamp | ISO 8601 timestamp |
| seed | Random seed for reproducibility |
| summary | Counts of samples, pathways, clusters |
| clusters | Sample count and label per cluster |
| validation | Results from validation gates |
| ground_truth | ARI vs planted subtypes (if available) |
| threshold_calibration | Calibrated validation thresholds and method used (present when auto-calibration is enabled) |

---

## report.md

### Description
Human-readable Markdown report for documentation.

### Sections

1. **Header**: Run name, date, seed
2. **Input Summary**: Table of input data counts
3. **Clustering Results**: Number of clusters and distribution
4. **Validation Gates**: Pass/fail status for mandatory tests
5. **Ground Truth Validation**: ARI score if planted subtypes available

### Use Cases

- Include in publications as supplementary material
- Share with collaborators
- Document analysis runs

---

## Validation Gates

The pipeline runs mandatory validation gates to assess clustering quality before results should be trusted.

### Tests Performed

| Test | Purpose | Pass Condition |
|------|---------|----------------|
| **Label Shuffle** | Verify clustering doesn't find spurious patterns | Mean ARI < 0.1 |
| **Random Gene Sets** | Verify clusters are driven by biological pathways | Mean ARI < 0.1 |
| **Bootstrap Stability** | Verify clusters are robust to resampling | Mean ARI >= 0.7 |

### Test Descriptions

#### Label Shuffle (Negative Control 1)

Shuffles sample labels randomly and re-clusters. The clustering should NOT recover the shuffled labels (ARI should be ~0). If clustering CAN recover shuffled labels, it suggests the clusters are artifacts of the method rather than real structure in the data.

- **Metric**: `mean_null_ARI` (average ARI across permutations)
- **Threshold**: < 0.1
- **PASS**: Clustering does not find spurious patterns
- **FAIL**: Method may be producing artifacts

#### Random Gene Sets (Negative Control 2)

Replaces biological pathway definitions with random gene sets of the same sizes and re-clusters. Clustering on random gene sets should NOT recover the original cluster structure.

- **Metric**: `mean_random_ARI` (average ARI across permutations)
- **Threshold**: < 0.1
- **PASS**: Clusters are driven by biological pathway definitions
- **FAIL**: Random gene groupings produce similar results

#### Bootstrap Stability

Resamples the data with replacement and re-runs clustering. Stable clusters should be recovered across bootstrap samples (high ARI).

- **Metric**: `mean_bootstrap_ARI` (average ARI across bootstrap samples)
- **Threshold**: >= 0.7
- **PASS**: Clusters are stable and reproducible
- **FAIL**: Clusters are sensitive to sample composition

### Interpreting Validation Gate Results

| Result | Interpretation | Action |
|--------|----------------|--------|
| **All PASS** | Clusters have passed basic sanity checks | Proceed with caution, still requires biological validation |
| **Label Shuffle FAIL** | Clustering may be finding artifacts | Review method parameters, consider different approach |
| **Random Genes FAIL** | Pathways may not be driving clusters | Verify pathway database quality |
| **Stability FAIL** | Clusters are not robust | Increase sample size or reduce cluster count |

### Important Caveats

- **PASS does not mean biologically valid**: Validation gates only check statistical properties
- **FAIL does not mean results are useless**: Results may still be informative for hypothesis generation
- **Small datasets**: May not pass all gates due to limited sample size

---

## Interpretation Guardrails

### Required Context for Any Finding

1. **Cohort context**: Results are relative to the analyzed cohort
2. **Pathway database version**: Different databases yield different results
3. **Parameter choices**: Clustering parameters affect subtype boundaries
4. **Statistical uncertainty**: Confidence intervals should always be considered

### Validation Requirements Before Any Claim

| Claim Type | Required Validation |
|------------|---------------------|
| "Subtype X exists" | Replication in independent cohort |
| "Pathway Y is disrupted" | Functional validation (cellular/animal) |
| "Gene Z contributes" | Segregation analysis, functional assays |
| "Treatment implication" | Clinical trial |

### Confidence Thresholds

| Metric | Threshold | Interpretation |
|--------|-----------|----------------|
| ARI (vs ground truth) | >0.7 | Acceptable cluster recovery |
| Bootstrap stability | >=0.7 | Stable cluster assignments |
| Label shuffle null ARI | <0.1 | No spurious patterns |
| Random gene sets ARI | <0.1 | Pathways drive clustering |
| Confidence score | >0.9 | High-confidence assignment |

---

## What NOT to Infer

### Clinical Decisions

> **NEVER use these outputs for:**
> - Diagnosis of any disease or condition
> - Treatment selection or modification
> - Genetic counseling without clinical validation
> - Insurance or legal decisions
> - Any decision affecting patient care

### Causal Claims

> **These outputs do NOT establish:**
> - That a pathway causes disease
> - That a gene is pathogenic
> - That subtypes have different prognoses
> - That interventions targeting pathways would help

### Generalization

> **Results may NOT generalize to:**
> - Other cohorts with different demographics
> - Individuals not in the analyzed cohort
> - Different ancestral backgrounds
> - Future patients

---

## Responsible Use Checklist

Before sharing or publishing results, verify:

- [ ] Disclaimer is prominently displayed
- [ ] Limitations are clearly stated
- [ ] Results are described as "hypothesis-generating"
- [ ] No clinical recommendations are made
- [ ] Validation requirements are acknowledged
- [ ] Cohort context is provided
- [ ] Statistical uncertainty is reported

---

## Questions?

If you're unsure how to interpret an output, **do not guess**. Contact the development team or consult a biostatistician with genomics expertise.

---

*Last updated: February 2026 | Pathway Subtyping Framework v0.2*
